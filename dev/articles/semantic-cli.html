<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Building a Semantic CLI • cli</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Building a Semantic CLI">
<meta property="og:description" content="cli">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cli</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">2.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/faq.html">FAQ</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/semantic-cli.html">Building a Semantic CLI</a>
    </li>
    <li>
      <a href="../articles/pluralization.html">CLI pluralization</a>
    </li>
    <li>
      <a href="../articles/rules-boxes-trees.html">Rules, Boxes and Trees</a>
    </li>
    <li>
      <a href="../articles/usethis-ui.html">From usethis::ui functions to cli</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-lib/cli/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="semantic-cli_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="semantic-cli_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="semantic-cli_files/asciinema_player-2.6.1/asciinema-player.css" rel="stylesheet">
<script src="semantic-cli_files/asciinema_player-2.6.1/asciinema-player.js"></script><script src="semantic-cli_files/jquery-3.2.1/jquery-3.2.1.min.js"></script><script src="semantic-cli_files/asciinema_player-binding-1.0.0.9000/asciinema_player.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Building a Semantic CLI</h1>
                        <h4 class="author">Gábor Csárdi</h4>
            
            <h4 class="date">2021-01-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/cli/blob/master/vignettes/semantic-cli.Rmd"><code>vignettes/semantic-cli.Rmd</code></a></small>
      <div class="hidden name"><code>semantic-cli.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Starting from version 2.0.0, the cli package can build a semantic Command Line Interface (CLI). By <em>semantic</em> we mean that <code>cli_*</code> functions that create console output are focused on the role of the text in the CLI, as opposed to how exactly it is formatted. The formatting of the CLI can be specified separately, and can be also customized by the end user. This is not unlike how HTML and CSS works as well, so it might be already familiar.</p>
<p>The semantic <code>cli_*</code> functions create semantic elements: headings, lists, alerts, paragraphs, etc. In this introduction we will go over these functions and also some common features of them.</p>
</div>
<div id="building-a-command-line-interface" class="section level1">
<h1 class="hasAnchor">
<a href="#building-a-command-line-interface" class="anchor"></a>Building a command line interface</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/cli#readme">cli</a></span><span class="op">)</span></code></pre></div>
<p>To build a CLI, you can simply start using the <code>cli_*</code> functions to create various CLI elements. Their exact formatting depends on the current theme, see ‘Theming’ below.</p>
<div id="alerts" class="section level2">
<h2 class="hasAnchor">
<a href="#alerts" class="anchor"></a>Alerts</h2>
<p>Alerts are typically short messages. cli has four types of alerts (success, info, warning, danger) and also a generic alert type:</p>
<pre class="asciicast"><code><a href="../reference/cli_alert.html">cli_alert_success("Updated database.")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-2.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/cli_alert.html">cli_alert_info("Reopened database.")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-3.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/cli_alert.html">cli_alert_warning("Cannot reach GitHub, using local database cache.")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-4.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/cli_alert.html">cli_alert_danger("Failed to connect to database.")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-5.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/cli_alert.html">cli_alert("A generic alert")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-6.svg" width="100%"></p>
</div>
<div id="text" class="section level2">
<h2 class="hasAnchor">
<a href="#text" class="anchor"></a>Text</h2>
<p>Text is automatically wrapped to the terminal width.</p>
<pre class="asciicast"><code><a href="../reference/cli_text.html">cli_text(cli:::lorem_ipsum())</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-7.svg" width="100%"></p>
</div>
<div id="paragraphs" class="section level2">
<h2 class="hasAnchor">
<a href="#paragraphs" class="anchor"></a>Paragraphs</h2>
<p>Paragraphs break the output. The default theme inserts an empty line before and after paragraphs, but only a single empty line is added between two paragraphs.</p>
<pre class="asciicast"><code>fun &lt;- function() {
  cli_par()
  cli_text("This is some text.")
  cli_text("Some more text.")
  cli_end()
  cli_par()
  cli_text("Already a new paragraph.")
  cli_end()
}
fun()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-8.svg" width="100%"></p>
<p><code><a href="../reference/cli_end.html">cli_end()</a></code> closes the latest open paragraph (or other open container).</p>
</div>
<div id="auto-closing-containers" class="section level2">
<h2 class="hasAnchor">
<a href="#auto-closing-containers" class="anchor"></a>Auto-closing containers</h2>
<p>If a paragraph (or other container, see ‘Generic containers’ later), is opened within a function, cli automatically closes it at the end of the function, by default. So in the previous example the last <code><a href="../reference/cli_end.html">cli_end()</a></code> call is not needed. Use <code>.auto_close = FALSE</code> in <code><a href="../reference/cli_par.html">cli_par()</a></code> to leave the paragraph open after its calling function returns.</p>
</div>
<div id="headings" class="section level2">
<h2 class="hasAnchor">
<a href="#headings" class="anchor"></a>Headings</h2>
<p>cli suppports three levels of headings. This is how they look in the default theme. The default theme adds an empty line before headings, and an empty line after <code><a href="../reference/cli_h1.html">cli_h1()</a></code> and <code><a href="../reference/cli_h1.html">cli_h2()</a></code>.</p>
<pre class="asciicast"><code><a href="../reference/cli_h1.html">cli_h1("Heading 1")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-9.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/cli_h1.html">cli_h2("Heading 2")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-10.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/cli_h1.html">cli_h3("Heading 3")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-11.svg" width="100%"></p>
</div>
<div id="interpolation" class="section level2">
<h2 class="hasAnchor">
<a href="#interpolation" class="anchor"></a>Interpolation</h2>
<p>All cli text is treated as a glue template, with special formatters available (see the ‘Inline text formatting’ Section):</p>
<pre class="asciicast"><code>size &lt;- 123143123
dt &lt;- 1.3454
cli_alert_info(c(
  "Downloaded {prettyunits::pretty_bytes(size)} in ",
  "{prettyunits::pretty_sec(dt)}"))</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-12.svg" width="100%"></p>
</div>
<div id="inline-text-formatting" class="section level2">
<h2 class="hasAnchor">
<a href="#inline-text-formatting" class="anchor"></a>Inline text formatting</h2>
<p>To define inline markup, you can use the regular glue braces, and after the opening brace, supply the name of the markup formatter with a leading dot, e.g. for emphasised text, you use <code>.emph</code>. Some examples are below, see <code><a href="../reference/inline-markup.html">?"inline-markup"</a></code> for details.</p>
<pre class="asciicast"><code>fun &lt;- function() {
  cli_ul()
  cli_li("{.emph Emphasized} text")
  cli_li("{.strong Strong} importance")
  cli_li("A piece of code: {.code sum(a) / length(a)}")
  cli_li("A package name: {.pkg cli}")
  cli_li("A function name: {.fn cli_text}")
  cli_li("A keyboard key: press {.kbd ENTER}")
  cli_li("A file name: {.file /usr/bin/env}")
  cli_li("An email address: {.email bugs.bunny@acme.com}")
  cli_li("A URL: {.url https://acme.com}")
  cli_li("An environment variable: {.envvar R_LIBS}")
  cli_li("Some {.field field}")
}
fun()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-13.svg" width="100%"></p>
<p>To combine inline markup and string interpolation, you need to add another set of braces:</p>
<pre class="asciicast"><code>dlurl &lt;- "https://httpbin.org/status/404"
cli_alert_danger("Failed to download {.url {dlurl}}.")</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-14.svg" width="100%"></p>
<p><code>"val"</code> is a special inline style, that in the default theme calls <code><a href="../reference/cli_format.html">cli_format()</a></code> to tailor the conversion of values to strings. The conversion can be themed, see “Theming” below.</p>
<pre class="asciicast"><code><a href="../reference/cli_div.html">cli_div(theme = list(.val = list(digits = 2)))
cli_text("Some random numbers: {.val {runif(4)}}.")
cli_end()</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-15.svg" width="100%"></p>
</div>
<div id="inline-lists-of-items" class="section level2">
<h2 class="hasAnchor">
<a href="#inline-lists-of-items" class="anchor"></a>Inline lists of items</h2>
<p>When cli performs inline text formatting, it automatically collapses glue substitutions, after formatting. This is handy to create lists of files, packages, etc.</p>
<pre class="asciicast"><code>pkgs &lt;- c("pkg1", "pkg2", "pkg3")
cli_text("Packages: {pkgs}.")</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-16.svg" width="100%"></p>
<pre class="asciicast"><code>pkgs &lt;- c("pkg1", "pkg2", "pkg3")
cli_text("Packages: {.pkg {pkgs}}")</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-17.svg" width="100%"></p>
</div>
<div id="non-breaking-spaces" class="section level2">
<h2 class="hasAnchor">
<a href="#non-breaking-spaces" class="anchor"></a>Non-breaking spaces</h2>
<p>Use <code>\u00a0</code> to create a non-breaking space. E.g. in here we insert some non-breaking spaces, and mark them with an <code>X</code>, so it is easy to see that there are no line breaks at a non-breaking space:</p>
<pre class="asciicast"><code># Make some spaces non-breaking, and mark them with X
txt &lt;- cli:::lorem_ipsum()
mch &lt;- gregexpr(txt, pattern = " ", fixed = TRUE)
nbs &lt;- runif(length(mch[[1]])) &lt; 0.5
regmatches(txt, mch)[[1]] &lt;- ifelse(nbs, "X\u00a0", " ")
cli_text(txt)</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-18.svg" width="100%"></p>
</div>
<div id="lists" class="section level2">
<h2 class="hasAnchor">
<a href="#lists" class="anchor"></a>Lists</h2>
<p>cli has three types of list: ordered, unordered and definition lists, see <code><a href="../reference/cli_ol.html">cli_ol()</a></code>, <code><a href="../reference/cli_ul.html">cli_ul()</a></code> amd <code><a href="../reference/cli_dl.html">cli_dl()</a></code>:</p>
<pre class="asciicast"><code><a href="../reference/cli_ol.html">cli_ol(c("item 1", "item 2", "item 3"))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-19.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/cli_ul.html">cli_ul(c("item 1", "item 2", "item 3"))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-20.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/cli_dl.html">cli_dl(c("item 1" = "description 1", "item 2" = "description 2",
         "item 3" = "description 3"))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-21.svg" width="100%"></p>
<p>Item text is wrapped to the terminal width:</p>
<pre class="asciicast"><code><a href="../reference/cli_ul.html">cli_ul(c("item 1" = cli:::lorem_paragraph(1, 20),
         "item 2" = cli:::lorem_paragraph(1, 20)))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-22.svg" width="100%"></p>
<div id="adding-list-items-iteratively" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-list-items-iteratively" class="anchor"></a>Adding list items iteratively</h3>
<p>Items can be added one by one:</p>
<pre class="asciicast"><code>fun &lt;- function() {
  lid &lt;- cli_ul()
  cli_li("Item 1")
  cli_li("Item 2")
  cli_li("Item 3")
  cli_end(lid)
}
fun()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-23.svg" width="100%"></p>
<p>The <code><a href="../reference/cli_ul.html">cli_ul()</a></code> call creates a list container, and because its items are not specified, it leaves the container open. Then items can be added one by one. (The last <code><a href="../reference/cli_end.html">cli_end()</a></code> is not necessary, because by default containers auto-close when their calling function exits.)</p>
</div>
<div id="adding-text-to-an-item-iteratively" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-text-to-an-item-iteratively" class="anchor"></a>Adding text to an item iteratively</h3>
<p><code><a href="../reference/cli_li.html">cli_li()</a></code> creates a new container for the list item, within the list container. You can keep adding text to the item, until the container is closed via <code><a href="../reference/cli_end.html">cli_end()</a></code> or a new <code><a href="../reference/cli_li.html">cli_li()</a></code>, which closes the current item container, and creates another one for the new item:</p>
<pre class="asciicast"><code>fun &lt;- function() {
  cli_ul()
  cli_li("First item")
  cli_text("This is still the first item")
  cli_li("This is the second item")
}
fun()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-24.svg" width="100%"></p>
</div>
<div id="nested-lists" class="section level3">
<h3 class="hasAnchor">
<a href="#nested-lists" class="anchor"></a>Nested lists</h3>
<p>To create nested lists, open nested containers:</p>
<pre class="asciicast"><code>fun &lt;- function() {
  cli_ol()
  cli_li("Item 1")
  ulid &lt;- cli_ul()
  cli_li("Subitem 1")
  cli_li("Subitem 2")
  cli_end(ulid)
  cli_li("Item 2")
  cli_end()
}
fun()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-25.svg" width="100%"></p>
<p>In <code><a href="../reference/cli_end.html">cli_end(olid)</a></code>, the <code>olid</code> is necessary, otherwise <code><a href="../reference/cli_end.html">cli_end()</a></code> would only close the container of the list item.</p>
</div>
</div>
<div id="horizontal-rules" class="section level2">
<h2 class="hasAnchor">
<a href="#horizontal-rules" class="anchor"></a>Horizontal rules</h2>
<p><code><a href="../reference/cli_rule.html">cli_rule()</a></code> creates a horizontal rule.</p>
<pre class="asciicast"><code><a href="../reference/cli_rule.html">cli_rule(left = "Compiling {.pkg mypackage}")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-26.svg" width="100%"></p>
<p>You can use the usual inline markup in the labels of the rule. The rule’s appearance is specified in the current theme. In particular:</p>
<ul>
<li>
<code>before</code> is added before the rule.</li>
<li>
<code>after</code> is added after the rule.</li>
<li>
<code>color</code> is used for the color of the rule <em>and</em> the labels. (Use color within the label text for a different label color.)</li>
<li>
<code>background-color</code>: is the background color for the rule and the labels. (Again, you can use a different background color within the label itself.)</li>
<li>
<code>margin-top</code>, <code>margin-bottom</code> for empty space above and below the rule.</li>
<li>
<code>line-type</code> specifies the line type of the rule. See <code><a href="../reference/cli_rule.html">?cli_rule</a></code> for line types.</li>
</ul>
</div>
<div id="the-status-bar" class="section level2">
<h2 class="hasAnchor">
<a href="#the-status-bar" class="anchor"></a>The status bar</h2>
<p>cli supports creating a status bar in the last line of the console, if the terminal supports the carriage return control character to move the cursor to the beginning of the line. This is supported in all terminals, in RStudio, Emacs, RGui, R.app, etc. It is not supported if the output is a file, e.g. typically on CI systems.</p>
<p><code><a href="../reference/cli_status.html">cli_status()</a></code> creates a new status bar, <code><a href="../reference/cli_status_update.html">cli_status_update()</a></code> updates a status bar, and <code><a href="../reference/cli_status_clear.html">cli_status_clear()</a></code> clears it. <code><a href="../reference/cli_status.html">cli_status()</a></code> returns an id, that can be used in <code><a href="../reference/cli_status_update.html">cli_status_update()</a></code> and <code><a href="../reference/cli_status_clear.html">cli_status_clear()</a></code> to refer to the right status bar.</p>
<p>While it is possible to create multiple status bars, on a typical terminal only one of them can be shown at any time. cli by default shows the one that was last created or updated.</p>
<p>While the status bar is active, cli can still produce output, as normal. This output is created “above” the status bar, which is always kept in the last line of the screen. See the following example:</p>
<pre class="asciicast"><code>f &lt;- function() {
  cli_alert_info("About to start downloads.")
  sb &lt;- cli_status("{symbol$arrow_right} Downloading 10 files.")
  for (i in 9:1) {
    Sys.sleep(0.5)
    if (i == 5) cli_alert_success("Already half-way!")
    cli_status_update(id = sb,
      "{symbol$arrow_right} Got {10-i} files, downloading {i}")
  }
  cli_status_clear(id = sb)
  cli_alert_success("Downloads done.")
}
f()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-27.svg" width="100%"></p>
</div>
</div>
<div id="theming" class="section level1">
<h1 class="hasAnchor">
<a href="#theming" class="anchor"></a>Theming</h1>
<p>The looks of the various CLI elements can be changed via themes. The cli package comes with a simple built-in theme, and new themes can be added as well.</p>
<div id="tags-ids-and-classes" class="section level2">
<h2 class="hasAnchor">
<a href="#tags-ids-and-classes" class="anchor"></a>Tags, ids and classes</h2>
<p>Similarly to HTML document, the elements of a CLI form a tree of nodes. Each node has exactly one tag, at most one id, and optionally a set of classes. E.g. <code><a href="../reference/cli_par.html">cli_par()</a></code> creates a node with a <code>&lt;p&gt;</code> tag, <code><a href="../reference/cli_ol.html">cli_ol()</a></code> creates a node with an <code>&lt;ol&gt;</code> tag, etc. Here is an example CLI tree. It always starts with a <code>&lt;body&gt;</code> tag with id <code>"body"</code>, this is created automatically.</p>
<pre><code>&lt;body id="body"&gt;
  &lt;par&gt;
    &lt;ol&gt;
      &lt;it&gt;
        &lt;span class="pkg"&gt;</code></pre>
<p>A cli theme is a named list, where the names are selectors based on tag names, ids and classes, and the elements of the list are style declarations. For example, the style of <code>&lt;h1&gt;</code> tags looks like this in the built-in theme:</p>
<pre class="asciicast"><code>builtin_theme()$h1</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-28.svg" width="100%"></p>
<p>See also <code><a href="../reference/themes.html">?cli::themes</a></code> for the reference and <code><a href="../reference/simple_theme.html">?cli::simple_theme</a></code> for an example theme.</p>
</div>
<div id="generic-containers" class="section level2">
<h2 class="hasAnchor">
<a href="#generic-containers" class="anchor"></a>Generic containers</h2>
<p><code><a href="../reference/cli_div.html">cli_div()</a></code> is a generic container, that does not produce any output, but it can add a new theme. This theme is removed when the <code>&lt;div&gt;</code> node is closed. (Like other containers, <code><a href="../reference/cli_div.html">cli_div()</a></code> auto-closes when the calling function exits.)</p>
<pre class="asciicast"><code>fun &lt;- function() {
  cli_div(theme = list (.alert = list(color = "red")))
  cli_alert("This will be red")
  cli_end()
  cli_alert("Back to normal color")
}
fun()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-29.svg" width="100%"></p>
</div>
<div id="theming-inline-markup" class="section level2">
<h2 class="hasAnchor">
<a href="#theming-inline-markup" class="anchor"></a>Theming inline markup</h2>
<p>The inline markup formatters always use a <code>&lt;span&gt;</code> tag, and add the name of the formatter as a class.</p>
<pre class="asciicast"><code>fun &lt;- function() {
  cli_div(theme = list(span.emph = list(color = "orange")))
  cli_text("This is very {.emph important}")
  cli_end()
  cli_text("Back to the {.emph previous theme}")
}
fun()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-30.svg" width="100%"></p>
<p>In addition to adding inline markup explicitly, like <code>.emph</code> here, cli can use the class(es) of the substituted expression to style it automatically. This can be configured as part of the theme, in the form of a mapping from the <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> of the expression, to the name of the markup formatter. For example, if we have a <code>filename</code> S3 class, we can make sure that it is always shown as a <code>.file</code> in the cli output:</p>
<pre class="asciicast"><code>fun &lt;- function() {
  cli_div(theme = list(body = list("class-map" = list("filename" = "file"))))
  fns &lt;- structure(c("file1", "file2", "file3"), class = "filename")
  cli_text("Found some files: {fns}.")
  cli_end()
}
fun()</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-31.svg" width="100%"></p>
</div>
</div>
<div id="cli-messages" class="section level1">
<h1 class="hasAnchor">
<a href="#cli-messages" class="anchor"></a>CLI messages</h1>
<p>All <code>cli_*()</code> functions are implemented using standard R conditions. For example a <code><a href="../reference/cli_alert.html">cli_alert()</a></code> call emits an R condition with class <code>cli_message</code>. These messages can be caught, muffled, transfered from a subprocess to the main R process.</p>
<p>When a cli function is called:</p>
<ol style="list-style-type: decimal">
<li>cli throws a <code>cli_message</code> condition.</li>
<li>If this condition is caught and muffled (via the <code>cli_message_handled</code> restart), then nothing else happens.</li>
<li>Otherwise the <code>cli.default_handler</code> option is checked and if this is a function, then it is called with the message.</li>
<li>If the <code>cli.default_handler</code> option is not set, or it is not a function, the default cli handler is called, which shows the text, alert, heading, etc. on the screen, using the standard R <code><a href="https://rdrr.io/r/base/message.html">message()</a></code> function.</li>
</ol>
<pre class="asciicast"><code><a href="https://rdrr.io/r/base/conditions.html">tryCatch(cli_h1("Heading"), cli_message = function(x) x)
suppressMessages(cli_text("Not shown"))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-32.svg" width="100%"></p>
</div>
<div id="subprocesses" class="section level1">
<h1 class="hasAnchor">
<a href="#subprocesses" class="anchor"></a>Subprocesses</h1>
<p>If <code>cli_*()</code> commands are invoked in a subprocess via <code><a href="https://rdrr.io/pkg/callr/man/r_session.html">callr::r_session</a></code> (see <a href="https://callr.r-lib.org" class="uri">https://callr.r-lib.org</a>), and the <code>cli.message_class</code> option is set to <code>"callr_message"</code>, then cli messages are automatically copied to the main R process:</p>
<pre class="asciicast"><code>rs &lt;- callr::r_session$new()
rs$run(function() {
  options(cli.message_class = "callr_message")
  cli::cli_text("This is subprocess {.emph {Sys.getpid()}} from {.pkg callr}")
  Sys.getpid()
})
invisible(rs$close())</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-33.svg" width="100%"></p>
</div>
<div id="utility-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#utility-functions" class="anchor"></a>Utility functions</h1>
<div id="ansi-colors" class="section level2">
<h2 class="hasAnchor">
<a href="#ansi-colors" class="anchor"></a>ANSI colors</h2>
<p>cli has functions to create ANSI colored or styled output in the console. <code>col_*</code> functions change the foreground color, <code>bg_*</code> functions change the background color, and <code>style_*</code> functions change the style of the text in some way.</p>
<p>These functions concatenate their arguments using <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, and add the <code>ansi_string</code> class to their result:</p>
<pre class="asciicast"><code><a href="https://rdrr.io/r/base/cat.html">cat(col_red("This ", "is ", "red."), sep = "\n")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-34.svg" width="100%"></p>
<p>Foreground colors:</p>
<pre class="asciicast"><code><a href="../reference/cli_ul.html">cli_ul(c(
  col_black("black"),
  col_blue("blue"),
  col_cyan("cyan"),
  col_green("green"),
  col_magenta("magenta"),
  col_red("red"),
  col_white("white"),
  col_yellow("yellow"),
  col_grey("grey")
))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-35.svg" width="100%"></p>
<p>Note that these might actually look different depending on your terminal theme. Background colors:</p>
<pre class="asciicast"><code><a href="../reference/cli_ul.html">cli_ul(c(
  bg_black("black background"),
  bg_blue("blue background"),
  bg_cyan("cyan background"),
  bg_green("green background"),
  bg_magenta("magenta background"),
  bg_red("red background"),
  bg_white("white background"),
  bg_yellow("yellow background")
))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-36.svg" width="100%"></p>
<p>Text styles:</p>
<pre class="asciicast"><code><a href="../reference/cli_ul.html">cli_ul(c(
  style_dim("dim style"),
  style_blurred("blurred style"),
  style_bold("bold style"),
  style_hidden("hidden style"),
  style_inverse("inverse style"),
  style_italic("italic style"),
  style_reset("reset style"),
  style_strikethrough("strikethrough style"),
  style_underline("underline style")
))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-37.svg" width="100%"></p>
<p>Not all <code>style_*</code> functions are supported by all terminals.</p>
<p>Colors, background colors and styles can be combined:</p>
<pre class="asciicast"><code><a href="../reference/ansi-styles.html">bg_white(style_bold(col_red("TITLE")))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-38.svg" width="100%"></p>
<p><code><a href="../reference/make_ansi_style.html">make_ansi_style()</a></code> can create custom colors, assuming your terminal supports them. <code><a href="../reference/combine_ansi_styles.html">combine_ansi_styles()</a></code> combines several styles into a function:</p>
<pre class="asciicast"><code>col_warn &lt;- combine_ansi_styles(make_ansi_style("pink"), style_bold)
col_warn("This is a warning in pink!")
cat(col_warn("This is a warning in pink!"))</code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-39.svg" width="100%"></p>
</div>
<div id="console-capabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#console-capabilities" class="anchor"></a>Console capabilities</h2>
<p>Query the console width:</p>
<pre class="asciicast"><code><a href="../reference/console_width.html">console_width()</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-40.svg" width="100%"></p>
<p>Query if the console supports ansi escapes:</p>
<pre class="asciicast"><code><a href="../reference/is_ansi_tty.html">is_ansi_tty()</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-41.svg" width="100%"></p>
<p>Hide the cursor, if the console supports it (no-op otherwise):</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ansi_hide_cursor.html">ansi_hide_cursor</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/ansi_hide_cursor.html">ansi_show_cursor</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>See also <code><a href="../reference/ansi_hide_cursor.html">ansi_with_hidden_cursor()</a></code>.</p>
<p>Query if the console supports <code>\r</code>:</p>
<pre class="asciicast"><code><a href="../reference/is_dynamic_tty.html">is_dynamic_tty()</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-43.svg" width="100%"></p>
<p>Query if the console supports UTF-8 output:</p>
<pre class="asciicast"><code><a href="../reference/is_utf8_output.html">is_utf8_output()</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-44.svg" width="100%"></p>
</div>
<div id="unicode-characters" class="section level2">
<h2 class="hasAnchor">
<a href="#unicode-characters" class="anchor"></a>Unicode characters</h2>
<p>The <code>symbol</code> variable includes some Unicode characters that are often useful in CLI messages. They automatically fall back to ASCII symbols if the platform does not support them. You can use these symbols both with the semantic <code>cli_*()</code> functions and directly.</p>
<pre class="asciicast"><code><a href="../reference/cli_text.html">cli_text("{symbol$tick} no errors  |  {symbol$cross} 2 warnings")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-45.svg" width="100%"></p>
<p>Here is a list of all symbols:</p>
<pre class="asciicast"><code><a href="../reference/symbol.html">list_symbols()</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-46.svg" width="100%"></p>
<p>Most symbols were inspired by (and copied from) the awesome <a href="https://github.com/sindresorhus/figures">figures</a> JavaScript project.</p>
</div>
<div id="spinners" class="section level2">
<h2 class="hasAnchor">
<a href="#spinners" class="anchor"></a>Spinners</h2>
<p>See <code><a href="../reference/list_spinners.html">list_spinners()</a></code> and <code><a href="../reference/get_spinner.html">get_spinner()</a></code>. From the awesome <a href="https://github.com/sindresorhus/cli-spinners#readme">cli-spinners</a> project.</p>
<pre class="asciicast"><code><a href="../reference/list_spinners.html">list_spinners()</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-47.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/get_spinner.html">get_spinner("dots")</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-48.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/ansi_hide_cursor.html">ansi_with_hidden_cursor(demo_spinners("dots"))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-49.svg" width="100%"></p>
<pre class="asciicast"><code><a href="../reference/ansi_hide_cursor.html">ansi_with_hidden_cursor(demo_spinners("clock"))</a></code></pre>
<p><img src="semantic-cli_files/figure-html/unnamed-chunk-50.svg" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gábor Csárdi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
